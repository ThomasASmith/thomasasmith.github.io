<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Use Case 05: Analysis of trials (including methods for analysing spillover) • CRTspat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use Case 05: Analysis of trials (including methods for analysing spillover)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CRTspat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Usecase1.html">Use Case 01: Algorithmic specification of clusters</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase10.html">Use Case 10: Power sample size and bias calculations using a diffusion model for spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase2.html">Use Case 02: Simulation of trials with geographical spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase3.html">Use Case 03: Estimation of intracluster correlations (ICC) by cluster size</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase4.html">Use Case 04: Estimation of optimal cluster size for a trial with pre-determined buffer width</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase5.html">Use Case 05: Analysis of trials (including methods for analysing spillover)</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase6.html">Use Case 06: Thematic mapping of the geography of a CRT</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase7.html">Use Case 07: Power and sample size calculations allowing for spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase8.html">Use Case 08: Eggs - to fry or scramble?</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase9.html">Use Case 09: Preparation of datasets for `CRTspat`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Use Case 05: Analysis of trials (including methods for analysing spillover)</h1>
            
      

      <div class="d-none name"><code>Usecase5.Rmd</code></div>
    </div>

    
    
<p>The <a href="../reference/CRTanalysis.html"><code>CRTanalysis()</code></a>
function is a wrapper for different statistical analysis packages that
can be used to analyse either simulated or real trial datasets. It is
designed for use in simulation studies of different analytical methods
for spatial CRTs by automating the data processing and selecting some
appropriate analysis options. It does not replace conventional use of
these packages. Real field trials very often entail complications that
are not catered for any of the analysis options in
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> and it does not aspire to carry out the full
analytical workflow for a trial. It can be used as part of a wider
workflow. In particular the usual object output by the statistical
analysis package constitutes the <code>model_object</code> element
within the <code>CRTanalysis</code> object generated by
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>. This can be accessed by the usual methods
(e.g <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>,
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>) which may be needed for diagnosing errors,
assessing goodness of fit, and for identifying needs for additional
analyses.</p>
<div class="section level2">
<h2 id="statistical-methods">Statistical Methods<a class="anchor" aria-label="anchor" href="#statistical-methods"></a>
</h2>
<p>The <a href="../reference/CRTanalysis.html"><code>CRTanalysis()</code></a>
function analyses trials with outcomes that may be either proportions,
rates, or continuous variables. The type of outcome and and the
corresponding link function are specified with the parameter
<code>link</code>. The options that can be specified using the
<code>method</code> parameter in the function call are:</p>
<ul>
<li>
<code>method = "T"</code> summarises the outcome at the level of the
cluster, and uses 2-sample t-tests to carry out statistical significance
tests of the effect, and to compute confidence intervals for the effect
size. The <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test" class="external-link">t.test</a>
function in the <code>stats</code> package is used.</li>
<li>
<code>method = "GEE"</code> uses Generalised Estimating Equations to
estimate the efficacy in a model with iid random effects for the
clusters. An estimate of the intracluster correlation (ICC) is also
provided. This uses calls to the <a href="https://CRAN.R-project.org/package=gee" class="external-link">gee</a> package.</li>
<li>
<code>method = "LME4"</code> fits linear (for continuous data) or
generalized linear (for counts and proportions) mixed models with iid
random effects for clusters in <a href="https://CRAN.R-project.org/package=lme4" class="external-link">lme4</a>.</li>
<li>
<code>method = "MCMC"</code> uses Markov chain Monte Carlo
simulation in package <a href="https://CRAN.R-project.org/package=rstan" class="external-link">rstan</a>.</li>
<li>
<code>method = "INLA"</code> uses approximate Bayesian inference via
the <a href="https://www.r-inla.org/" class="external-link">R-INLA package</a>. This provides
functionality for geostatistical analysis, which can be used for
geographical mapping of model outputs (as illustrated in . INLA spatial
analysis requires a prediction mesh. This can be generated using <a href="../reference/compute_mesh.html"><code>CRTspat::compute_mesh()</code></a>.
This can be computationally expensive, so it is recommended to compute
the mesh just once for each dataset.</li>
</ul>
<p>All these analysis methods can be used to carry out a simple
comparision of outcomes between trial arms. Each offers different
additional functionality, and has its own limitations (see Table 5.1).
Some of these limitations are specific to the options offered within
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>, which does not embrace the full range of
options of the packages that are ‘wrapped’. These are specified using
the <code>method</code> argument of the function.</p>
<p>Table 5.1. Available statistical methods</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="9%">
<col width="50%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th><code>method</code></th>
<th>Package</th>
<th>What the <code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> implementation offers</th>
<th>Limitations (as implemented)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>T</code></td>
<td><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test" class="external-link">t.test</a></td>
<td>P-values and confidence intervals for efficacy based on comparison
of cluster means</td>
<td>No analysis of spillover or degree of clustering</td>
</tr>
<tr class="even">
<td><code>GEE</code></td>
<td><a href="https://CRAN.R-project.org/package=gee" class="external-link">gee</a></td>
<td>Interval estimates for efficacy</td>
<td>No analysis of spillover or degree of clustering</td>
</tr>
<tr class="odd">
<td><code>LME4</code></td>
<td><a href="https://CRAN.R-project.org/package=lme4" class="external-link">lme4</a></td>
<td>Analysis of spillover</td>
<td>No geostatistical analysis</td>
</tr>
<tr class="even">
<td><code>INLA</code></td>
<td><a href="https://www.r-inla.org/" class="external-link">INLA</a></td>
<td>Analysis of spillover, geostatistical analysis and spatially
structured outputs</td>
<td>Computationally intensive</td>
</tr>
<tr class="odd">
<td><code>MCMC</code></td>
<td><a href="https://CRAN.R-project.org/package=rstan" class="external-link">rstan</a></td>
<td>Interval estimates for spillover parameters</td>
<td>Identifiability issues and slow convergence are possible</td>
</tr>
</tbody>
</table>
<p>For the analysis of proportions, the outcome in the control arm is
estimated as:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>C</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>β</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{p}_{C} = \frac{1}{1 + exp(-\beta_1)}</annotation></semantics></math>,
in the intervention arm as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>I</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>β</mi><mn>1</mn></msub><mo>−</mo><msub><mi>β</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{p}_{I} = \frac{1}{1 + exp(-\beta_1-\beta_2)}</annotation></semantics></math>,
and the efficacy is estimated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>E</mi><mo accent="true">̃</mo></mover><mi>s</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mi>I</mi></msub><msub><mover><mi>p</mi><mo accent="true">̃</mo></mover><mi>C</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\tilde{E}_{s} = 1- \frac{\tilde{p}_{I}}{\tilde{p}_{C}}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math>
is the intercept term and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>
the incremental effect associated with the intervention.</p>
<p><code>summary("&lt;analysis&gt;"")</code> is used to view the key
results of the trial. To display the output from the statistical
procedure that is called, try <code>&lt;analysis&gt;$model_object</code>
or <code>summary("&lt;analysis&gt;$model_object")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CRTspat</span><span class="op">)</span></span>
<span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readdata.html">readdata</a></span><span class="op">(</span><span class="st">"exampleCRT.txt"</span><span class="op">)</span></span>
<span><span class="va">analysisT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisT</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  T </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  arm + (1 | cluster) </span></span>
<span><span class="co">## No modelling of spillover </span></span>
<span><span class="co">## Estimates:       Control: 0.364 (95% CL: 0.286 0.451)</span></span>
<span><span class="co">##             Intervention: 0.21 (95% CL: 0.147 0.292)</span></span>
<span><span class="co">##                 Efficacy: 0.423 (95% CL: 0.208 0.727)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## P-value (2-sided):  0.006879064</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisT</span><span class="op">$</span><span class="va">model_object</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  lp by arm</span></span>
<span><span class="co">## t = 2.9818, df = 22, p-value = 0.006879</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group control and group intervention is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.2332638 1.2989425</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##      mean in group control mean in group intervention </span></span>
<span><span class="co">##                 -0.5561662                 -1.3222694</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="assessing-model-fit">Assessing model fit<a class="anchor" aria-label="anchor" href="#assessing-model-fit"></a>
</h2>
<p>The <code>method = "LME4"</code> option outputs the deviance of the
model and the Akaike information criterion (AIC), which can be used to
select the best fitting model. The deviance information criterion (DIC)
and Bayesian information criterion (BIC) perform the same role for
<code>method = "INLA"</code>. For <code>method = "MCMC"</code>
goodness-of-fit is assessed using the LOO criterion (package <a href="https://CRAN.R-project.org/package=loo" class="external-link">loo</a>). The comparison
of results with <code>cfunc = "X"</code> and <code>cfunc = "Z"</code> is
used to assess whether the intervention effect is likely to be due to
chance. With <code>method = "T"</code>, <code>cfunc = "X"</code>
provides a significance test of the intervention effect directly. The
models with spillover (see below) can be compared by that with
<code>cfunc = "X"</code> to evaluate whether spillover has led to an
important bias.</p>
</div>
<div class="section level2">
<h2 id="spillover">Spillover<a class="anchor" aria-label="anchor" href="#spillover"></a>
</h2>
<p><code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> provides options for analysing spillover
effects either as function of a Euclidean distance or as a function of a
surround measure:</p>
<div class="section level4">
<h4 id="models-that-do-not-consider-spillover">Models that do not consider spillover<a class="anchor" aria-label="anchor" href="#models-that-do-not-consider-spillover"></a>
</h4>
<p>Models that do not consider spillover can be fitted using options
<code>Z</code> and <code>X</code>. These are included both to allow
conventional analyses (see above), and also to enable model selection
using and likelihood ratio tests, the Akaike information criterion
(AIC), deviance information criterion (DIC) or Bayesian information
criterion (BIC) .</p>
</div>
<div class="section level4">
<h4 id="spillover-as-a-function-of-distance">Spillover as a function of distance<a class="anchor" aria-label="anchor" href="#spillover-as-a-function-of-distance"></a>
</h4>
<p>These methods require a measure of distance from the boundary between
the trial arms, with locations in the control arm assigned negative
values, and those in the intervention arm assigned positive values. The
functional forms for this relationship is specified by the value of
<code>cfunc</code> (Table 5.2).</p>
<p>Table 5.2. Available spillover functions</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="22%">
<col width="32%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th><code>cfunc</code></th>
<th>Description</th>
<th>Formula for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P\left( d \right)</annotation></semantics></math>
</th>
<th>Compatible <code>method</code>(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Z</code></td>
<td>No intervention effect</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mn>0</mn><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">P\left( d \right) = \ 0\ </annotation></semantics></math></td>
<td>
<code>GEE</code> <code>LME4</code> <code>INLA</code>
<code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>X</code></td>
<td>Simple intervention effect</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mn>0</mn><mspace width="0.222em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mi>d</mi><mspace width="0.222em"></mspace><mo>&lt;</mo><mspace width="0.222em"></mspace><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mn>1</mn><mspace width="0.222em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mi>d</mi><mspace width="0.222em"></mspace><mo>&gt;</mo><mspace width="0.222em"></mspace><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">\begin{matrix}
     P\left( d \right) = \ 0\ for\ d\  &lt; \ 0 \\
     P\left( d \right) = \ 1\ for\ d\  &gt; \ 0 \\
     \end{matrix}\ </annotation></semantics></math></td>
<td>
<code>T</code> <code>GEE</code> <code>LME4</code> <code>INLA</code>
<code>MCMC</code>
</td>
</tr>
<tr class="odd">
<td><code>L</code></td>
<td>inverse logistic (sigmoid)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mfrac><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mspace width="0.222em"></mspace><mo>+</mo><mspace width="0.222em"></mspace><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>d</mi><mi>/</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P\left( d \right) = \ \frac{1}{\left( 1\  + \ exp\left( - d/S \right) \right)}</annotation></semantics></math></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>P</code></td>
<td>inverse probit (error function)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo>+</mo><mspace width="0.222em"></mspace><mi>e</mi><mi>r</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>d</mi><mrow><mi>S</mi><msqrt><mn>2</mn></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P\left( d \right) = 1\ +\ erf\left(\frac{d}{S\sqrt2}\right)</annotation></semantics></math></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="odd">
<td><code>S</code></td>
<td>piecewise linear</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mn>0</mn><mspace width="0.222em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mi>d</mi><mspace width="0.222em"></mspace><mo>&lt;</mo><mspace width="0.222em"></mspace><mo>−</mo><mi>S</mi><mi>/</mi><mn>2</mn><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mi>/</mi><mn>2</mn><mspace width="0.222em"></mspace><mo>+</mo><mspace width="0.222em"></mspace><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>S</mi><mspace width="0.222em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mo>−</mo><mi>S</mi><mi>/</mi><mn>2</mn><mo>&lt;</mo><mi>d</mi><mspace width="0.222em"></mspace><mo>&lt;</mo><mspace width="0.222em"></mspace><mi>S</mi><mi>/</mi><mn>2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mspace width="0.222em"></mspace><mn>1</mn><mspace width="0.222em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mi>d</mi><mspace width="0.222em"></mspace><mo>&gt;</mo><mspace width="0.222em"></mspace><mi>S</mi><mi>/</mi><mn>2</mn><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">\begin{matrix}
    P\left( d \right) = \ 0\  for\ d\  &lt; \  - S/2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \\
    P\left( d \right) = \ \left(S/2\  + \ d \right)/S\ for\  - S/2 &lt; d\  &lt; \ S/2\\
    P\left( d \right) = \ 1\  for\ d\  &gt; \ S/2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \\
    \end{matrix}\ </annotation></semantics></math></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>R</code></td>
<td>rescaled linear</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>d</mi><mspace width="0.222em"></mspace><mo>−</mo><mspace width="0.222em"></mspace><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mo>−</mo><mspace width="0.222em"></mspace><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">P\left( d \right) =\frac{d\ -\ min(d)}{max(d)\ -\ min(d)}</annotation></semantics></math></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="odd">
<td><code>D</code></td>
<td>diffusion</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo>+</mo><mspace width="0.222em"></mspace><mi>e</mi><mi>r</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>d</mi><mrow><mi>S</mi><msqrt><mn>2</mn></msqrt></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P\left( d \right) = 1\ +\ erf\left(\frac{d}{S\sqrt2}\right)</annotation></semantics></math></td>
<td><code>MCMC</code></td>
</tr>
</tbody>
</table>
<p>With <code>cfunc</code> options other than <code>D</code> the
spillover function is applied on the scale of the linear predictor. With
option <code>D</code> the spillover function is on the same scale as the
outcome (which matches the linear predictor only if
<code>link = "identity"</code>). Option <code>D</code> corresponds to
the <a href="https://doi.org/10.21203/rs.3.rs-5423058/v1" class="external-link">diffusion
model of spillover</a>.</p>
<p><code>cfunc</code> options <code>P</code>, <code>L</code>,
<code>S</code> and <code>D</code> lead to non-linear models in which the
spillover scale parameter (<code>S</code>) must be estimated. With the
<code>LME4</code> and <code>INLA</code> options this is done by
optimising the <code>scale_par</code> by running the generalised linear
model iteratively within a one-dimensional optimisation of the goodness
of fit of the model in <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">stats::optimize()</a></code>. With the
<code>MCMC</code> option the MCMC algorithm fits the scale parameter as
part of the overall non-linear model fit.</p>
<p>Different values for <code>cfunc</code> lead to the fitted curves
shown in Figure 5.1. The light blue shaded part of the plot corresponds
to the spillover interval in those cases where this is estimated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"Z"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_Z</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  (1 | cluster) </span></span>
<span><span class="co">## No comparison of arms </span></span>
<span><span class="co">## Estimates:       Control: 0.285 (95% CL: 0.231 0.346)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1391.609</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_X</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  arm + (1 | cluster) </span></span>
<span><span class="co">## No modelling of spillover </span></span>
<span><span class="co">## Estimates:       Control: 0.367 (95% CL: 0.291 0.448)</span></span>
<span><span class="co">##             Intervention: 0.216 (95% CL: 0.16 0.281)</span></span>
<span><span class="co">##                 Efficacy: 0.412 (95% CL: 0.171 0.587)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1385.898</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"P"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_P</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">##  with estimation of scale parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Error function model for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.418 (95% CL: 0.331 0.512)</span></span>
<span><span class="co">##             Intervention: 0.186 (95% CL: 0.135 0.249)</span></span>
<span><span class="co">##                 Efficacy: 0.554 (95% CL: 0.331 0.705)</span></span>
<span><span class="co">##          Scale parameter: 0.45 (95% CL: 0.45 0.45)</span></span>
<span><span class="co">##   Spillover interval(km): 1.749 (95% CL: 1.728 1.762)</span></span>
<span><span class="co">## Pr in spillover interval: 0.685 (95% CL: 0.685 0.685)</span></span>
<span><span class="co">##    Ipsilateral Spillover: 0.009 (95% CL: 0 0.094)</span></span>
<span><span class="co">##  Contralateral Spillover: 0.032 (95% CL: 0 0.13)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1382.215 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_L</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">##  with estimation of scale parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Sigmoid (logistic) function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.415 (95% CL: 0.331 0.507)</span></span>
<span><span class="co">##             Intervention: 0.186 (95% CL: 0.135 0.251)</span></span>
<span><span class="co">##                 Efficacy: 0.551 (95% CL: 0.329 0.701)</span></span>
<span><span class="co">##          Scale parameter: 0.249 (95% CL: 0.249 0.249)</span></span>
<span><span class="co">##   Spillover interval(km): 1.81 (95% CL: 1.776 1.823)</span></span>
<span><span class="co">## Pr in spillover interval: 0.706 (95% CL: 0.706 0.706)</span></span>
<span><span class="co">##    Ipsilateral Spillover: 0.009 (95% CL: 0 0.098)</span></span>
<span><span class="co">##  Contralateral Spillover: 0.03 (95% CL: 0 0.127)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1382.201 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">##  with estimation of scale parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Piecewise linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.423 (95% CL: 0.335 0.516)</span></span>
<span><span class="co">##             Intervention: 0.185 (95% CL: 0.134 0.247)</span></span>
<span><span class="co">##                 Efficacy: 0.563 (95% CL: 0.34 0.71)</span></span>
<span><span class="co">##          Scale parameter: 1.674 (95% CL: 1.674 1.674)</span></span>
<span><span class="co">##   Spillover interval(km): 1.586 (95% CL: 1.586 1.593)</span></span>
<span><span class="co">## Pr in spillover interval: 0.633 (95% CL: 0.633 0.633)</span></span>
<span><span class="co">##    Ipsilateral Spillover: 0.012 (95% CL: 0 0.11)</span></span>
<span><span class="co">##  Contralateral Spillover: 0.051 (95% CL: 0 0.139)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1382.094 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_R</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_R</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">##  with no non-linear parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.585 (95% CL: 0.386 0.76)</span></span>
<span><span class="co">##             Intervention: 0.116 (95% CL: 0.06 0.211)</span></span>
<span><span class="co">##                 Efficacy: 0.8 (95% CL: 0.478 0.918)</span></span>
<span><span class="co">##          Scale parameter: 1 (95% CL: 1 1)</span></span>
<span><span class="co">##   Spillover interval(km): 6.372 (95% CL: 6.243 6.433)</span></span>
<span><span class="co">## Pr in spillover interval: 0.997 (95% CL: 0.997 0.997)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1384.711</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_Z</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_X</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_P</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_L</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_S</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_R</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Z'</span>, <span class="st">'X'</span>, <span class="st">'P'</span>, <span class="st">'L'</span>, <span class="st">'S'</span>, <span class="st">'R'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5b.r-1.png" alt=""><br><em>Fig 5.1 Fitted curves for
the example dataset with different options for <code>cfunc</code></em>
</p>
<p>The piecewise linear spillover function, <code>cfunc = "S"</code>, is
only linear on the scale of the linear predictor. When used in a
logistic model, as here, the transformation via the inverse of the link
function leads to a slightly curved plot (Figure 5.1S). The rescaled
linear function, <code>cfunc = "R"</code>, is provided as a comparator
and for use with <code>distance</code> values other than
<code>distance = "nearestDiscord"</code> see below (it should not be
used to estimate the spillover interval).</p>
<p>The full set of different <code>cfunc</code> options are available
for each of model options <code>"LME4"</code>, <code>"INLA"</code>, and
<code>"MCMC"</code>. The performance of all these different models has
not yet been thoroughly investigated. The analyses of <a href="https://malariajournal.biomedcentral.com/articles/10.1186/s12936-021-03924-7" class="external-link">Multerer
<em>et al.</em> (2021b)</a> found that that a model equivalent to
<code>method = "MCMC"</code>, <code>cfunc = "L"</code> gave estimates of
efficacy with low bias, even in simulations with considerable
spillover.</p>
</div>
<div class="section level4">
<h4 id="spillover-as-a-function-of-surround">Spillover as a function of surround<a class="anchor" aria-label="anchor" href="#spillover-as-a-function-of-surround"></a>
</h4>
<p>Spillover can also be analysed by assuming the effect size to be a
function of the number of intervened locations in the surroundings of
the location <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316" class="external-link">Anaya-Izquierdo
&amp; Alexander(2021)</a>. Several different surround functions are
available. These are specified by the <code>distance</code> parameter
(Table 5.3).</p>
<p>Table 5.3. Available surround functions</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="18%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th><code>distance</code></th>
<th>Description</th>
<th>Details</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>nearestDiscord</code></td>
<td>Distance to nearest discordant location</td>
<td>The default. This is used for analyses by distance (see above)</td>
</tr>
<tr class="even">
<td><code>hdep</code></td>
<td>Tukey half-depth</td>
<td>Algorithm of <a href="https://www.jstor.org/stable/2986073" class="external-link">Rousseeuw &amp;
Ruts(1996)</a>
</td>
</tr>
<tr class="odd">
<td><code>sdep</code></td>
<td>Simplicial depth</td>
<td>Algorithm of <a href="https://www.jstor.org/stable/2986073" class="external-link">Rousseeuw &amp;
Ruts(1996)</a>
</td>
</tr>
<tr class="even">
<td><code>disc</code></td>
<td>disc</td>
<td>The number of intervened locations within the specified radius
(excluding the location itself) as described by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316" class="external-link">Anaya-Izquierdo
&amp; Alexander(2021)</a>
</td>
</tr>
<tr class="odd">
<td><code>kern</code></td>
<td>Sum of kernels</td>
<td>The sum of normal kernels</td>
</tr>
</tbody>
</table>
<p>The <a href="../reference/compute_distance.html"><code>compute_distance()</code></a>
function is provided to compute these quantities, so that they can be
described, compared, and analysed independently of
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>. Note that the values of the surround
calculated by <code><a href="../reference/compute_distance.html">compute_distance()</a></code> are scaled to avoid
correlation with the spatial density of the points (see <a href="../reference/compute_distance.html">documentation</a>) and so are
not equivalent to the quantities reported in the original
publications.</p>
<p>Users can also devise other measures of surround or distance, add
them to a <code>trial</code> data frame and specify them using
<code>distance</code>. <code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> computes the minimum
value for the specified field</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">example</span>, distance <span class="op">=</span> <span class="st">"hdep"</span><span class="op">)</span></span>
<span><span class="va">ps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"hdep"</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"sdep"</span><span class="op">)</span></span>
<span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"disc"</span>, scale_par <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">ps3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"disc"</span><span class="op">)</span></span>
<span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"kern"</span>, scale_par <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">ps4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"kern"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">ps1</span>, <span class="va">ps2</span>, <span class="va">ps3</span>, <span class="va">ps4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hdep'</span>, <span class="st">'sdep'</span>, <span class="st">'disc'</span>, <span class="st">'kern'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5c.r-1.png" alt=""><br><em>Fig 5.2 Stacked bar plots
for different surrounds</em>
</p>
<p>If <code>distance</code> is assigned a value of either
<code>hdep</code>, <code>sdep</code>, then <code>cfunc = "R"</code> is
used by default and the overall effect size is computed by comparing the
fitted values of the model for a surround value of zero with that of the
maximum of the surround in the data. If <code>distance = "disc"</code>
or <code>distance = "kern"</code> and <code>scale_par</code> is assigned
a value, then <code>cfunc = "R"</code> is also used. If
<code>cfunc = "E"</code> is specified then an escape function is fitted
with the scale parameter estimated in the same way as in the scale
parameter in other models (see above Table 5.2).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examples_hdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"hdep"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_hdep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Tukey half-depth </span></span>
<span><span class="co">##  with no non-linear parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.382 (95% CL: 0.293 0.478)</span></span>
<span><span class="co">##             Intervention: 0.208 (95% CL: 0.151 0.282)</span></span>
<span><span class="co">##                 Efficacy: 0.454 (95% CL: 0.168 0.644)</span></span>
<span><span class="co">##          Scale parameter: 1 (95% CL: 1 1)</span></span>
<span><span class="co">##   Spillover interval(km): 0.939 (95% CL: 0.928 0.947)</span></span>
<span><span class="co">## Pr in spillover interval: 0.529 (95% CL: 0.529 0.529)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1385.89</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_hdep</span><span class="op">)</span></span>
<span><span class="va">examples_sdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"sdep"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_sdep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Simplicial depth </span></span>
<span><span class="co">##  with no non-linear parameter.  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.394 (95% CL: 0.309 0.488)</span></span>
<span><span class="co">##             Intervention: 0.199 (95% CL: 0.144 0.267)</span></span>
<span><span class="co">##                 Efficacy: 0.495 (95% CL: 0.25 0.661)</span></span>
<span><span class="co">##          Scale parameter: 1 (95% CL: 1 1)</span></span>
<span><span class="co">##   Spillover interval(km): 0.937 (95% CL: 0.927 0.945)</span></span>
<span><span class="co">## Pr in spillover interval: 0.485 (95% CL: 0.485 0.485)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1382.417</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_sdep</span><span class="op">)</span></span>
<span><span class="va">examples_disc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"disc"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span>, scale_par <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_disc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: disc of radius 0.15 km</span></span>
<span><span class="co">##  with precalculated scale parameter of 0.15:  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.387 (95% CL: 0.312 0.47)</span></span>
<span><span class="co">##             Intervention: 0.2 (95% CL: 0.15 0.262)</span></span>
<span><span class="co">##                 Efficacy: 0.482 (95% CL: 0.276 0.632)</span></span>
<span><span class="co">##          Scale parameter: 0.15 (95% CL: 0.15 0.15)</span></span>
<span><span class="co">##   Spillover interval(km): 0.938 (95% CL: 0.928 0.945)</span></span>
<span><span class="co">## Pr in spillover interval: 0.089 (95% CL: 0.089 0.089)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1380.274</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_disc</span>,legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">examples_kern</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"kern"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span>, scale_par <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_kern</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: kern with kernel s.d. 0.15 km</span></span>
<span><span class="co">##  with precalculated scale parameter of 0.15:  </span></span>
<span><span class="co">## Model formula:  effect + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control: 0.406 (95% CL: 0.328 0.491)</span></span>
<span><span class="co">##             Intervention: 0.185 (95% CL: 0.137 0.247)</span></span>
<span><span class="co">##                 Efficacy: 0.544 (95% CL: 0.342 0.684)</span></span>
<span><span class="co">##          Scale parameter: 0.15 (95% CL: 0.15 0.15)</span></span>
<span><span class="co">##   Spillover interval(km): 0.935 (95% CL: 0.925 0.944)</span></span>
<span><span class="co">## Pr in spillover interval: 0.59 (95% CL: 0.59 0.59)</span></span>
<span><span class="co">## Coefficient of variation: 48.425 (95% CL: 35.969 75.865)</span></span>
<span><span class="co">## deviance                :  NA </span></span>
<span><span class="co">## AIC                     :  1375.677</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_kern</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">ps4</span>, <span class="va">ps5</span>, <span class="va">ps6</span>, <span class="va">ps7</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hdep'</span>, <span class="st">'sdep'</span>, <span class="st">'disc'</span>, <span class="st">'kern'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5d.r-1.png" alt=""><br><em>Fig 5.3 Fitted curves for
the example dataset with different surrounds </em>
</p>
</div>
</div>
<div class="section level2">
<h2 id="geostatistical-models-and-mapping-results">Geostatistical models and mapping results<a class="anchor" aria-label="anchor" href="#geostatistical-models-and-mapping-results"></a>
</h2>
<p>To carry out a geostatistical analysis with
<code>method = "INLA"</code> a prediction mesh is needed. By default a
very low resolution mesh is created (creating a high resolution mesh is
computationally expensive). To create a 100m INLA mesh for
<code>&lt;MyTrial&gt;</code>, use:</p>
<p><code>mesh &lt;- compute_mesh(trial = &lt;MyTrial&gt; , pixel = 0.1)</code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
