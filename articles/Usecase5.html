<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CRTspat">
<title>Use Case 05: Analysis of trials (including methods for analysing spillover) • CRTspat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use Case 05: Analysis of trials (including methods for analysing spillover)">
<meta property="og:description" content="CRTspat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CRTspat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Usecase1.html">Use Case 01: Algorithmic specification of clusters</a>
    <a class="dropdown-item" href="../articles/Usecase2.html">Use Case 02: Simulation of trials with geographical spillover</a>
    <a class="dropdown-item" href="../articles/Usecase3.html">Use Case 03: Estimation of intracluster correlations (ICC) by cluster size</a>
    <a class="dropdown-item" href="../articles/Usecase4.html">Use Case 04: Estimation of optimal cluster size for a trial with pre-determined buffer width</a>
    <a class="dropdown-item" href="../articles/Usecase5.html">Use Case 05: Analysis of trials (including methods for analysing spillover)</a>
    <a class="dropdown-item" href="../articles/Usecase6.html">Use Case 06: Thematic mapping of the geography of a CRT</a>
    <a class="dropdown-item" href="../articles/Usecase7.html">Use Case 07: Power and sample size calculations allowing for spillover</a>
    <a class="dropdown-item" href="../articles/Usecase8.html">Use Case 08: Eggs - to fry or scramble?</a>
    <a class="dropdown-item" href="../articles/Usecase9.html">Use Case 09: Preparation of datasets for `CRTspat`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use Case 05: Analysis of trials (including methods for analysing spillover)</h1>
            
      
      
      <div class="d-none name"><code>Usecase5.Rmd</code></div>
    </div>

    
    
<p>The <a href="../reference/CRTanalysis.html"><code>CRTanalysis()</code></a>
function is a wrapper for different statistical analysis packages that
can be used to analyse either simulated or real trial datasets. It is
designed for use in simulation studies of different analytical methods
for spatial CRTs by automating the data processing and selecting some
appropriate analysis options. It does not replace conventional use of
these packages. Real field trials very often entail complications that
are not catered for any of the analysis options in
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> and it does not aspire to carry out the full
analytical workflow for a trial. It can be used as part of a wider
workflow. In particular the usual object output by the statistical
analysis package constitutes the <code>model_object</code> element
within the <code>CRTanalysis</code> object generated by
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>. This can be accessed by the usual methods
(e.g <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>,
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>) which may be needed for diagnosing errors,
assessing goodness of fit, and for identifying needs for additional
analyses.</p>
<div class="section level2">
<h2 id="statistical-methods">Statistical Methods<a class="anchor" aria-label="anchor" href="#statistical-methods"></a>
</h2>
<p>The options that can be specified using the <code>method</code>
parameter in the function call are:</p>
<ul>
<li>
<code>method = "T"</code> summarises the outcome at the level of the
cluster, and uses 2-sample t-tests to carry out statistical significance
tests of the effect, and to compute confidence intervals for the effect
size. The <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test" class="external-link">t.test</a>
function in the <code>stats</code> package is used.</li>
<li>
<code>method = "GEE"</code> uses Generalised Estimating Equations to
estimate the efficacy in a model with iid random effects for the
clusters. An estimate of the intracluster correlation (ICC) is also
provided. This uses calls to the <a href="https://www.jstatsoft.org/article/view/v015i02" class="external-link">geepack</a>
package.</li>
<li>
<code>method = "LME4"</code> fits linear (for continuous data) or
generalized linear (for counts and proportions) mixed models with iid
random effects for clusters in <a href="https://CRAN.R-project.org/package=lme4" class="external-link">lme4</a>.</li>
<li>
<code>method = "MCMC"</code> uses Markov chain Monte Carlo
simulation in package <a href="https://CRAN.R-project.org/package=jagsUI" class="external-link">jagsUI</a>, which calls
r-JAGS.</li>
<li>
<code>method = "INLA"</code> uses approximate Bayesian inference via
the <a href="https://www.r-inla.org/" class="external-link">R-INLA package</a>. This provides
functionality for geostatistical analysis, which can be used for
geographical mapping of model outputs (as illustrated in . INLA spatial
analysis requires a prediction mesh. This can be generated using <a href="../reference/new_mesh().html"><code>CRTspat::new_mesh()</code></a>.
This can be computationally expensive, so it is recommended to compute
the mesh just once for each dataset.</li>
</ul>
<p>All these analysis methods can be used to carry out a simple
comparision of outcomes between trial arms. Each offers different
additional functionality, and has its own limitations (see Table 5.1).
Some of these limitations are specific to the options offered within
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>, which does not embrace the full range of
options of the packages that are ‘wrapped’. These are specified using
the <code>method</code> argument of the function.</p>
<p>Table 5.1. Available statistical methods</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="9%">
<col width="50%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th><code>method</code></th>
<th>Package</th>
<th>What the <code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> implementation offers</th>
<th>Limitations (as implemented)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>T</code></td>
<td><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test" class="external-link">t.test</a></td>
<td>P-values and confidence intervals for efficacy based on comparison
of cluster means</td>
<td>No analysis of spillover or degree of clustering</td>
</tr>
<tr class="even">
<td><code>GEE</code></td>
<td><a href="https://www.jstatsoft.org/article/view/v015i02" class="external-link">geepack</a></td>
<td>Interval estimates for efficacy and Intra-cluster correlations</td>
<td>No analysis of spillover or degree of clustering</td>
</tr>
<tr class="odd">
<td><code>LME4</code></td>
<td><a href="https://CRAN.R-project.org/package=lme4" class="external-link">lme4</a></td>
<td>Analysis of spillover</td>
<td>No geostatistical analysis</td>
</tr>
<tr class="even">
<td><code>INLA</code></td>
<td><a href="https://www.r-inla.org/" class="external-link">INLA</a></td>
<td>Analysis of spillover, geostatistical analysis and spatially
structured outputs</td>
<td>Computationally intensive</td>
</tr>
<tr class="odd">
<td><code>MCMC</code></td>
<td><a href="https://CRAN.R-project.org/package=jagsUI" class="external-link">jagsUI</a></td>
<td>Interval estimates for spillover parameters</td>
<td>Identifiability issues and slow convergence are possible</td>
</tr>
</tbody>
</table>
<p>For the analysis of proportions, the outcome in the control arm is
estimated as: <span class="math inline">\(\hat{p}_{C} = \frac{1}{1 +
exp(-\beta_1)}\)</span>, in the intervention arm as <span class="math inline">\(\hat{p}_{I} = \frac{1}{1 +
exp(-\beta_1-\beta_2)}\)</span>, and the efficacy is estimated as <span class="math inline">\(\tilde{E}_{s} = 1-
\frac{\tilde{p}_{I}}{\tilde{p}_{C}}\)</span> where <span class="math inline">\(\beta_1\)</span> is the intercept term and <span class="math inline">\(\beta_2\)</span> the incremental effect associated
with the intervention.</p>
<p><code>summary("&lt;analysis&gt;"")</code> is used to view the key
results of the trial. To display the output from the statistical
procedure that is called, try <code>&lt;analysis&gt;$model_object</code>
or <code>summary("&lt;analysis&gt;$model_object")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CRTspat</span><span class="op">)</span></span>
<span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readdata.html">readdata</a></span><span class="op">(</span><span class="st">"exampleCRT.txt"</span><span class="op">)</span></span>
<span><span class="va">analysisT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisT</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  T </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  arm + (1 | cluster) </span></span>
<span><span class="co">## No modelling of spillover </span></span>
<span><span class="co">## Estimates:       Control:  0.364  (95% CL:  0.286 0.451 )</span></span>
<span><span class="co">##             Intervention:  0.21  (95% CL:  0.147 0.292 )</span></span>
<span><span class="co">##                 Efficacy:  0.423  (95% CL:  0.208 0.727 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## P-value (2-sided):  0.00688</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisT</span><span class="op">$</span><span class="va">model_object</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  lp by arm</span></span>
<span><span class="co">## t = 3, df = 22, p-value = 0.007</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group control and group intervention is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.233 1.299</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##      mean in group control mean in group intervention </span></span>
<span><span class="co">##                     -0.556                     -1.322</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="assessing-model-fit">Assessing model fit<a class="anchor" aria-label="anchor" href="#assessing-model-fit"></a>
</h2>
<p>The <code>model = "LME4"</code> option outputs the deviance of the
model and the Akaike information criterion (AIC), which can be used to
select the best fitting model. The deviance information criterion (DIC)
and Bayesian information criterion (BIC) perform the same role for the
Bayesian methods (<code>"INLA"</code>, and <code>"MCMC"</code>). The
comparison of results with <code>cfunc = "X"</code> and
<code>cfunc = "Z"</code> is used to assess whether the intervention
effect is likely to be due to chance. With <code>method = "T"</code>,
<code>cfunc = "X"</code> provides a significance test of the
intervention effect directly. The models with spillover (see below) can
be compared by that with <code>cfunc = "X"</code> to evaluate whether
spillover has led to an important bias.</p>
</div>
<div class="section level2">
<h2 id="spillover">Spillover<a class="anchor" aria-label="anchor" href="#spillover"></a>
</h2>
<p><code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> provides options for analysing spillover
effects either as function of a Euclidean distance or as a function of a
surround measure:</p>
<div class="section level4">
<h4 id="models-that-do-not-consider-spillover">Models that do not consider spillover<a class="anchor" aria-label="anchor" href="#models-that-do-not-consider-spillover"></a>
</h4>
<p>Models that do not consider spillover can be fitted using options
<code>Z</code> and <code>X</code>. These are included both to allow
conventional analyses (see above), and also to enable model selection
using and likelihood ratio tests, the Akaike information criterion
(AIC), deviance information criterion (DIC) or Bayesian information
criterion (BIC) .</p>
</div>
<div class="section level4">
<h4 id="spillover-as-a-function-of-distance">Spillover as a function of distance<a class="anchor" aria-label="anchor" href="#spillover-as-a-function-of-distance"></a>
</h4>
<p>These methods require a measure of distance from the boundary between
the trial arms, with locations in the control arm assigned negative
values, and those in the intervention arm assigned positive values. The
functional forms for this relationship is specified by the value of
<code>cfunc</code> (Table 5.2).</p>
<p>Table 5.2. Available spillover functions</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="22%">
<col width="32%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th><code>cfunc</code></th>
<th>Description</th>
<th>Formula for <span class="math inline">\(P\left( d
\right)\)</span>
</th>
<th>Compatible <code>method</code>(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Z</code></td>
<td>No intervention effect</td>
<td><span class="math inline">\(P\left( d \right) = \ 0\ \)</span></td>
<td>
<code>GEE</code> <code>LME4</code> <code>INLA</code>
<code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>X</code></td>
<td>Simple intervention effect</td>
<td><span class="math inline">\(\begin{matrix}  P\left( d \right) = \ 0\
for\ d\  &lt; \ 0 \\  P\left( d \right) = \ 1\ for\ d\  &gt; \ 0
\\  \end{matrix}\ \)</span></td>
<td>
<code>T</code> <code>GEE</code> <code>LME4</code> <code>INLA</code>
<code>MCMC</code>
</td>
</tr>
<tr class="odd">
<td><code>L</code></td>
<td>inverse logistic (sigmoid)</td>
<td><span class="math inline">\(P\left( d \right) = \ \frac{1}{\left(
1\  + \ exp\left( - d/S \right) \right)}\)</span></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>P</code></td>
<td>inverse probit (error function)</td>
<td><span class="math inline">\(P\left( d \right) = 1\ +\
erf\left(\frac{d}{S\sqrt2}\right)\)</span></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="odd">
<td><code>S</code></td>
<td>piecewise linear</td>
<td><span class="math inline">\(\begin{matrix}  P\left( d \right) = \
0\  for\ d\  &lt; \  - S/2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \
\ \\  P\left( d \right) = \ \left(S/2\  + \ d \right)/S\ for\  - S/2
&lt; d\  &lt; \ S/2\\  P\left( d \right) = \ 1\  for\ d\  &gt; \ S/2\ \
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \\  \end{matrix}\
\)</span></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
<tr class="even">
<td><code>R</code></td>
<td>rescaled linear</td>
<td><span class="math inline">\(P\left( d \right) =\frac{d\ -\
min(d)}{max(d)\ -\ min(d)}\)</span></td>
<td>
<code>LME4</code> <code>INLA</code> <code>MCMC</code>
</td>
</tr>
</tbody>
</table>
<p><code>cfunc</code> options <code>P</code>, <code>L</code> and
<code>S</code> lead to non-linear models in which the spillover scale
parameter (<code>S</code>) must be estimated. This is done by selecting
<code>scale_par</code> using a one-dimensional optimisation of the
goodness of fit of the model in <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">stats::optimize()</a></code>.</p>
<p>The different values for <code>cfunc</code> lead to the fitted curves
shown in Figure 5.1. The light blue shaded part of the plot corresponds
to the spillover interval in those cases where this is estimated.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"Z"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_Z</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  (1 | cluster) </span></span>
<span><span class="co">## No comparison of arms </span></span>
<span><span class="co">## Estimates:       Control:  0.285  (95% CL:  NA )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1388 </span></span>
<span><span class="co">## AIC     :  1392</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_X</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Model formula:  arm + (1 | cluster) </span></span>
<span><span class="co">## No modelling of spillover </span></span>
<span><span class="co">## Estimates:       Control:  0.366  (95% CL:  0.292 0.449 )</span></span>
<span><span class="co">##             Intervention:  0.216  (95% CL:  0.162 0.281 )</span></span>
<span><span class="co">##                 Efficacy:  0.41  (95% CL:  0.165 0.584 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1380 </span></span>
<span><span class="co">## AIC     :  1386</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_P</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"P"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_P</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">## Estimated scale parameter: 0.45</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Error function model for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.418  (95% CL:  0.331 0.509 )</span></span>
<span><span class="co">##             Intervention:  0.186  (95% CL:  0.136 0.25 )</span></span>
<span><span class="co">##                 Efficacy:  0.553  (95% CL:  0.327 0.703 )</span></span>
<span><span class="co">## Spillover interval(km):      4.22  (95% CL:  4.2 4.23 )</span></span>
<span><span class="co">## % locations contaminated: 91.6  (95% CL:  90.6 92 %)</span></span>
<span><span class="co">## Total effect            : 0.23  (95% CL:  0.114 0.344 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.0233  (95% CL:  0.0127 0.0323 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0417  (95% CL:  0.0192 0.0651 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1374 </span></span>
<span><span class="co">## AIC     :  1382 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_L</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">## Estimated scale parameter: 0.249</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Sigmoid (logistic) function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.417  (95% CL:  0.332 0.51 )</span></span>
<span><span class="co">##             Intervention:  0.186  (95% CL:  0.136 0.249 )</span></span>
<span><span class="co">##                 Efficacy:  0.552  (95% CL:  0.329 0.7 )</span></span>
<span><span class="co">## Spillover interval(km):      4.26  (95% CL:  4.24 4.28 )</span></span>
<span><span class="co">## % locations contaminated: 92.7  (95% CL:  92.2 93.1 %)</span></span>
<span><span class="co">## Total effect            : 0.229  (95% CL:  0.115 0.342 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.0219  (95% CL:  0.0121 0.0304 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0388  (95% CL:  0.0183 0.0604 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1374 </span></span>
<span><span class="co">## AIC     :  1382 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_S</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">## Estimated scale parameter: 1.674</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Piecewise linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.423  (95% CL:  0.334 0.516 )</span></span>
<span><span class="co">##             Intervention:  0.185  (95% CL:  0.135 0.247 )</span></span>
<span><span class="co">##                 Efficacy:  0.561  (95% CL:  0.341 0.711 )</span></span>
<span><span class="co">## Spillover interval(km):      4.1  (95% CL:  4.1 4.11 )</span></span>
<span><span class="co">## % locations contaminated: 86.6  (95% CL:  86.6 87.1 %)</span></span>
<span><span class="co">## Total effect            : 0.237  (95% CL:  0.12 0.356 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.029  (95% CL:  0.016 0.0403 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0522  (95% CL:  0.0248 0.0818 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1374 </span></span>
<span><span class="co">## AIC     :  1382 including penalty for the spillover scale parameter</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analysisLME4_R</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, cfunc <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">analysisLME4_R</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Signed distance to other arm (km)</span></span>
<span><span class="co">## No non-linear parameter. 1</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.584  (95% CL:  0.381 0.758 )</span></span>
<span><span class="co">##             Intervention:  0.116  (95% CL:  0.0587 0.216 )</span></span>
<span><span class="co">##                 Efficacy:  0.801  (95% CL:  0.465 0.92 )</span></span>
<span><span class="co">## Spillover interval(km):      6.64  (95% CL:  6.61 6.65 )</span></span>
<span><span class="co">## % locations contaminated: 99.8  (95% CL:  99.8 99.8 %)</span></span>
<span><span class="co">## Total effect            : 0.468  (95% CL:  0.181 0.694 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.117  (95% CL:  0.0564 0.157 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.238  (95% CL:  0.0831 0.368 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1379 </span></span>
<span><span class="co">## AIC     :  1385</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_Z</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_X</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_P</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_L</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_S</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">analysisLME4_R</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p0</span>, <span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Z'</span>, <span class="st">'X'</span>, <span class="st">'P'</span>, <span class="st">'L'</span>, <span class="st">'S'</span>, <span class="st">'R'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5b.r-1.png"><br><em>Fig 5.1 Fitted curves for the
example dataset with different options for <code>cfunc</code></em>
</p>
<p>The piecewise linear spillover function, <code>cfunc = "S"</code>, is
only linear on the scale of the linear predictor. When used in a
logistic model, as here, the transformation via the inverse of the link
function leads to a slightly curved plot (Figure 5.1S). The rescaled
linear function, <code>cfunc = "R"</code>, is provided as a comparator
and for use with <code>distance</code> values other than
<code>distance = "nearestDiscord"</code> see below (it should not be
used to estimate the spillover interval).</p>
<p>The full set of different <code>cfunc</code> options are available
for each of model options <code>"LME4"</code>, <code>"INLA"</code>, and
<code>"MCMC"</code>. The performance of all these different models has
not yet been thoroughly investigated. The analyses of <a href="https://malariajournal.biomedcentral.com/articles/10.1186/s12936-021-03924-7" class="external-link">Multerer
<em>et al.</em> (2021b)</a> found that that a model equivalent to
<code>method = "MCMC"</code>, <code>cfunc = "L"</code> gave estimates of
efficacy with low bias, even in simulations with considerable
spillover.</p>
</div>
<div class="section level4">
<h4 id="spillover-as-a-function-of-surround">Spillover as a function of surround<a class="anchor" aria-label="anchor" href="#spillover-as-a-function-of-surround"></a>
</h4>
<p>Spillover can also be analysed by assuming the effect size to be a
function of the number of intervened locations in the surroundings of
the location <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316" class="external-link">Anaya-Izquierdo
&amp; Alexander(2021)</a>. Several different surround functions are
available. These are specified by the <code>distance</code> parameter
(Table 5.3).</p>
<p>Table 5.3. Available surround functions</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="18%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th><code>distance</code></th>
<th>Description</th>
<th>Details</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>nearestDiscord</code></td>
<td>Distance to nearest discordant location</td>
<td>The default. This is used for analyses by distance (see above)</td>
</tr>
<tr class="even">
<td><code>hdep</code></td>
<td>Tukey half-depth</td>
<td>Algorithm of <a href="https://www.jstor.org/stable/2986073" class="external-link">Rousseeuw &amp;
Ruts(1996)</a>
</td>
</tr>
<tr class="odd">
<td><code>sdep</code></td>
<td>Simplicial depth</td>
<td>Algorithm of <a href="https://www.jstor.org/stable/2986073" class="external-link">Rousseeuw &amp;
Ruts(1996)</a>
</td>
</tr>
<tr class="even">
<td><code>disc</code></td>
<td>disc</td>
<td>The number of intervened locations within the specified radius
(excluding the location itself) as described by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316" class="external-link">Anaya-Izquierdo
&amp; Alexander(2021)</a>
</td>
</tr>
<tr class="odd">
<td><code>kern</code></td>
<td>Sum of kernels</td>
<td>The sum of normal kernels</td>
</tr>
</tbody>
</table>
<p>The <a href="../reference/compute_distance.html"><code>compute_distance()</code></a>
function is provided to compute these quantities, so that they can be
described, compared, and analysed independently of
<code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code>. Note that the values of the surround
calculated by <code><a href="../reference/compute_distance.html">compute_distance()</a></code> are scaled to avoid
correlation with the spatial density of the points (see <a href="../reference/compute_distance.html">documentation</a>) and so are
not equivalent to the quantities reported in the original
publications.</p>
<p>Users can also devise other measures of surround or distance, add
them to a <code>trial</code> data frame and specify them using
<code>distance</code>. <code><a href="../reference/CRTanalysis.html">CRTanalysis()</a></code> computes the minimum
value for the specified field</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">example</span>, distance <span class="op">=</span> <span class="st">"hdep"</span><span class="op">)</span></span>
<span><span class="va">ps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"hdep"</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"sdep"</span><span class="op">)</span></span>
<span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"disc"</span>, scale_par <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">ps3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"disc"</span><span class="op">)</span></span>
<span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_distance.html">compute_distance</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"kern"</span>, scale_par <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">ps4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples</span>, distance <span class="op">=</span> <span class="st">"kern"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">ps1</span>, <span class="va">ps2</span>, <span class="va">ps3</span>, <span class="va">ps4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hdep'</span>, <span class="st">'sdep'</span>, <span class="st">'disc'</span>, <span class="st">'kern'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5c.r-1.png"><br><em>Fig 5.2 Stacked bar plots for
different surrounds</em>
</p>
<p>If <code>distance</code> is assigned a value of either
<code>hdep</code>, <code>sdep</code>, then <code>cfunc = "R"</code> is
used by default and the overall effect size is computed by comparing the
fitted values of the model for a surround value of zero with that of the
maximum of the surround in the data. If <code>distance = "disc"</code>
or <code>distance = "kern"</code> and <code>scale_par</code> is assigned
a value, then <code>cfunc = "R"</code> is also used. If
<code>cfunc = "E"</code> is specified then an escape function is fitted
with the scale parameter estimated in the same way as in the scale
parameter in other models (see above Table 5.2).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examples_hdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"hdep"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_hdep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Tukey half-depth </span></span>
<span><span class="co">## No non-linear parameter. 1</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.381  (95% CL:  0.292 0.478 )</span></span>
<span><span class="co">##             Intervention:  0.208  (95% CL:  0.15 0.281 )</span></span>
<span><span class="co">##                 Efficacy:  0.453  (95% CL:  0.169 0.639 )</span></span>
<span><span class="co">## Spillover interval(km):      0.978  (95% CL:  0.976 0.98 )</span></span>
<span><span class="co">## % locations contaminated: 54.7  (95% CL:  54.7 54.7 %)</span></span>
<span><span class="co">## Total effect            : 0.172  (95% CL:  0.0534 0.291 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.032  (95% CL:  0.0104 0.0522 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0448  (95% CL:  0.0132 0.079 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1380 </span></span>
<span><span class="co">## AIC     :  1386</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_hdep</span>,legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">examples_sdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"sdep"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_sdep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: Simplicial depth </span></span>
<span><span class="co">## No non-linear parameter. 1</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.389  (95% CL:  0.303 0.48 )</span></span>
<span><span class="co">##             Intervention:  0.201  (95% CL:  0.147 0.271 )</span></span>
<span><span class="co">##                 Efficacy:  0.482  (95% CL:  0.229 0.652 )</span></span>
<span><span class="co">## Spillover interval(km):      0.978  (95% CL:  0.976 0.98 )</span></span>
<span><span class="co">## % locations contaminated: 51.8  (95% CL:  51.7 51.9 %)</span></span>
<span><span class="co">## Total effect            : 0.187  (95% CL:  0.0746 0.298 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.0323  (95% CL:  0.0135 0.0501 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0437  (95% CL:  0.0165 0.0719 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1377 </span></span>
<span><span class="co">## AIC     :  1383</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_sdep</span><span class="op">)</span></span>
<span><span class="va">examples_disc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"disc"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span>, scale_par <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_disc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: disc of radius 0.15 km</span></span>
<span><span class="co">## Precalculated scale parameter: 0.15</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.387  (95% CL:  0.312 0.467 )</span></span>
<span><span class="co">##             Intervention:  0.2  (95% CL:  0.149 0.26 )</span></span>
<span><span class="co">##                 Efficacy:  0.482  (95% CL:  0.273 0.634 )</span></span>
<span><span class="co">## Spillover interval(km):      0.978  (95% CL:  0.976 0.98 )</span></span>
<span><span class="co">## % locations contaminated: 8.89  (95% CL:  8.89 8.89 %)</span></span>
<span><span class="co">## Total effect            : 0.186  (95% CL:  0.0912 0.282 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.00458  (95% CL:  0.00239 0.00656 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.00576  (95% CL:  0.00271 0.00905 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1374 </span></span>
<span><span class="co">## AIC     :  1380</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_disc</span><span class="op">)</span></span>
<span><span class="va">examples_kern</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">examples</span>, method <span class="op">=</span> <span class="st">"LME4"</span>, distance <span class="op">=</span> <span class="st">"kern"</span>, cfunc <span class="op">=</span> <span class="st">'R'</span>, scale_par <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">examples_kern</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## =====================CLUSTER RANDOMISED TRIAL ANALYSIS =================</span></span>
<span><span class="co">## Analysis method:  LME4 </span></span>
<span><span class="co">## Link function:  logit </span></span>
<span><span class="co">## Measure of distance or surround: kern with kernel s.d. 0.15 km</span></span>
<span><span class="co">## Precalculated scale parameter: 0.15</span></span>
<span><span class="co">## Model formula:  pvar + (1 | cluster) </span></span>
<span><span class="co">## Rescaled linear function for spillover</span></span>
<span><span class="co">## Estimates:       Control:  0.406  (95% CL:  0.327 0.491 )</span></span>
<span><span class="co">##             Intervention:  0.185  (95% CL:  0.136 0.245 )</span></span>
<span><span class="co">##                 Efficacy:  0.542  (95% CL:  0.349 0.684 )</span></span>
<span><span class="co">## Spillover interval(km):      0.979  (95% CL:  0.977 0.98 )</span></span>
<span><span class="co">## % locations contaminated: 50.8  (95% CL:  50.6 50.9 %)</span></span>
<span><span class="co">## Total effect            : 0.22  (95% CL:  0.122 0.32 )</span></span>
<span><span class="co">## Ipsilateral Spillover   : 0.011  (95% CL:  0.00661 0.0152 )</span></span>
<span><span class="co">## Contralateral Spillover : 0.0134  (95% CL:  0.00707 0.0203 )</span></span>
<span><span class="co">## Coefficient of variation:  41.6 %  (95% CL:  31.2 63.1 )</span></span>
<span><span class="co">## deviance:  1370 </span></span>
<span><span class="co">## AIC     :  1376</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCRT.html">plotCRT</a></span><span class="op">(</span><span class="va">examples_kern</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">ps4</span>, <span class="va">ps5</span>, <span class="va">ps6</span>, <span class="va">ps7</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hdep'</span>, <span class="st">'sdep'</span>, <span class="st">'disc'</span>, <span class="st">'kern'</span><span class="op">)</span>, label_size <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>
<img src="example5d.r-1.png"><br><em>Fig 5.3 Fitted curves for the
example dataset with different surrounds </em>
</p>
</div>
</div>
<div class="section level2">
<h2 id="geostatistical-models-and-mapping-results">Geostatistical models and mapping results<a class="anchor" aria-label="anchor" href="#geostatistical-models-and-mapping-results"></a>
</h2>
<p>To carry out a geostatistical analysis with
<code>method = "INLA"</code> a prediction mesh is needed. By default a
very low resolution mesh is created (creating a high resolution mesh is
computationally expensive). To create a 100m INLA mesh for
<code>&lt;MyTrial&gt;</code>, use:</p>
<p><code>mesh &lt;- new_mesh(trial = &lt;MyTrial&gt; , pixel = 0.1)</code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Thomas Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
