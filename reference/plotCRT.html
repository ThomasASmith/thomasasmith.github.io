<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Graphical displays of the geography of a CRT — plotCRT • CRTspat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical displays of the geography of a CRT — plotCRT"><meta name="description" content="plotCRT returns graphical displays of the geography of a CRT
or of the results of statistical analyses of a CRT"><meta property="og:description" content="plotCRT returns graphical displays of the geography of a CRT
or of the results of statistical analyses of a CRT"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CRTspat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Usecase1.html">Use Case 01: Algorithmic specification of clusters</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase10.html">Use Case 10: Power sample size and bias calculations using a diffusion model for spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase2.html">Use Case 02: Simulation of trials with geographical spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase3.html">Use Case 03: Estimation of intracluster correlations (ICC) by cluster size</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase4.html">Use Case 04: Estimation of optimal cluster size for a trial with pre-determined buffer width</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase5.html">Use Case 05: Analysis of trials (including methods for analysing spillover)</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase6.html">Use Case 06: Thematic mapping of the geography of a CRT</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase7.html">Use Case 07: Power and sample size calculations allowing for spillover</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase8.html">Use Case 08: Eggs - to fry or scramble?</a></li>
    <li><a class="dropdown-item" href="../articles/Usecase9.html">Use Case 09: Preparation of datasets for `CRTspat`</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Graphical displays of the geography of a CRT</h1>

      <div class="d-none name"><code>plotCRT.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotCRT</code> returns graphical displays of the geography of a CRT
or of the results of statistical analyses of a CRT</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotCRT</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"nearestDiscord"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"arms"</span>,</span>
<span>  showLocations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showClusterBoundaries <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showClusterLabels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showBuffer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cpalette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  buffer_width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maskbuffer <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  labelsize <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  legend.position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>object of class <code>'CRTanalysis'</code> produced by <code><a href="CRTanalysis.html">CRTanalysis()</a></code></p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>logical: indicator of whether a map is required</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>measure of distance or surround with options: <br></p><table class="table table"><tr><td><code>"nearestDiscord"</code></td><td>distance to nearest discordant location (km)</td></tr><tr><td><code>"disc"</code></td><td>disc</td></tr><tr><td><code>"hdep"</code></td><td>Tukey's half space depth</td></tr><tr><td><code>"sdep"</code></td><td>simplicial depth</td></tr></table></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>fill layer of map with options:</p><table class="table table"><tr><td><code>'cluster'</code></td><td>cluster assignment</td></tr><tr><td><code>'arms'</code></td><td>arm assignment</td></tr><tr><td><code>'nearestDiscord'</code></td><td>distance to the nearest discordant location</td></tr><tr><td><code>'disc'</code></td><td>disc measure of surround</td></tr><tr><td><code>'hdep'</code></td><td>Tukey's half space depth</td></tr><tr><td><code>'sdep'</code></td><td>simplicial depth</td></tr><tr><td><code>'prediction'</code></td><td>model prediction of the outcome</td></tr><tr><td><code>'none'</code></td><td>No fill</td></tr></table></dd>


<dt id="arg-showlocations">showLocations<a class="anchor" aria-label="anchor" href="#arg-showlocations"></a></dt>
<dd><p>logical: determining whether locations are shown</p></dd>


<dt id="arg-showclusterboundaries">showClusterBoundaries<a class="anchor" aria-label="anchor" href="#arg-showclusterboundaries"></a></dt>
<dd><p>logical: determining whether cluster boundaries are shown</p></dd>


<dt id="arg-showclusterlabels">showClusterLabels<a class="anchor" aria-label="anchor" href="#arg-showclusterlabels"></a></dt>
<dd><p>logical: determining whether the cluster numbers are shown</p></dd>


<dt id="arg-showbuffer">showBuffer<a class="anchor" aria-label="anchor" href="#arg-showbuffer"></a></dt>
<dd><p>logical: whether a buffer zone should be overlayed</p></dd>


<dt id="arg-cpalette">cpalette<a class="anchor" aria-label="anchor" href="#arg-cpalette"></a></dt>
<dd><p>colour palette (to use different colours for clusters this must be at
least as long as the number of clusters.</p></dd>


<dt id="arg-buffer-width">buffer_width<a class="anchor" aria-label="anchor" href="#arg-buffer-width"></a></dt>
<dd><p>width of buffer zone to be overlayed (km)</p></dd>


<dt id="arg-maskbuffer">maskbuffer<a class="anchor" aria-label="anchor" href="#arg-maskbuffer"></a></dt>
<dd><p>radius of buffer around inhabited areas (km)</p></dd>


<dt id="arg-labelsize">labelsize<a class="anchor" aria-label="anchor" href="#arg-labelsize"></a></dt>
<dd><p>size of cluster number labels</p></dd>


<dt id="arg-legend-position">legend.position<a class="anchor" aria-label="anchor" href="#arg-legend-position"></a></dt>
<dd><p>(using <code>ggplot2::themes</code> syntax)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>graphics object produced by the <code>ggplot2</code> package</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>map = FALSE</code> and the input is a trial data frame or a <code>CRTsp</code> object,
containing a randomisation to arms, a stacked bar chart of the outcome
grouped by the specified <code>distance</code> is produced. If the specified <code>distance</code>
has not yet been calculated an error is returned.<br><br>
If <code>map = FALSE</code> and the input is a <code>CRTanalysis</code> object a plot of the
estimated spillover function is generated. The fitted spillover function is plotted
as a continuous green/blue line against the measure of
the surround or of the distance to the nearest discordant location. Using the same axes, data summaries are plotted for
ten categories of distance from the boundary. Both the
average of the outcome and confidence intervals are plotted.If spillover limits have been estimated
then these limits are used to delimit a shaded rectangular overlay, providing they fall within the range of distances
in the data. If the spillover limits fall outside the range of the data then the range of distances in the data
define the boundaries of the shaded area.</p><ul><li><p>For analyses with logit link function the outcome is plotted as a proportion. <br></p></li>
<li><p>For analyses with log or cloglog link function the data are plotted on a scale of the Williams mean
(mean of exp(log(x + 1))) - 1) rescaled so that the median matches the fitted curve at the midpoint.<br></p></li>
</ul><p>If <code>map = TRUE</code> a thematic map corresponding to the value of <code>fill</code> is generated.</p><ul><li><p><code>fill = 'clusters'</code> or leads to thematic map showing the locations of the clusters</p></li>
<li><p><code>fill = 'arms'</code> leads to a thematic map showing the geography of the randomization</p></li>
<li><p><code>fill = 'distance'</code> leads to a raster plot of the distance to the nearest discordant location.</p></li>
<li><p><code>fill = 'prediction'</code> leads to a raster plot of predictions from an <code>'INLA'</code> model.</p></li>
</ul><p>If <code>showBuffer = TRUE</code> the map is overlaid with a grey transparent layer showing which
areas are within a defined distance of the boundary between the arms. Possibilities are:</p><ul><li><p>If the trial has not been randomised or if <code>showBuffer = FALSE</code> no buffer is displayed</p></li>
<li><p>If <code>buffer_width</code> takes a positive value then buffers of this width are
displayed irrespective of any pre-specified or spillover limits.</p></li>
<li><p>If the input is a <code>'CRTanalysis'</code> and spillover limits have been estimated
then these limits are used to define the displayed buffer providing they fall within the range of distances
in the data.</p></li>
<li><p>If <code>buffer_width</code> is not specified and no spillover limits are available, then any
pre-specified buffer (e.g. one generated by <code><a href="specify_buffer.html">specify_buffer()</a></code>) is displayed.</p></li>
</ul><p>A message is output indicating which of these possibilities applies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="op">{</span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="readdata.html">readdata</a></span><span class="op">(</span><span class="st">'exampleCRT.txt'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Plot of data by distance</span></span></span>
<span class="r-in"><span><span class="fu">plotCRT</span><span class="op">(</span><span class="va">example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Map of locations only</span></span></span>
<span class="r-in"><span><span class="fu">plotCRT</span><span class="op">(</span><span class="va">example</span>, map <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">'none'</span>, showLocations <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           showClusterBoundaries<span class="op">=</span><span class="cn">FALSE</span>, maskbuffer<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#show cluster boundaries and number clusters</span></span></span>
<span class="r-in"><span><span class="fu">plotCRT</span><span class="op">(</span><span class="va">example</span>, map <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span><span class="st">'none'</span>, showClusterBoundaries<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>           showClusterLabels<span class="op">=</span><span class="cn">TRUE</span>, maskbuffer<span class="op">=</span><span class="fl">0.2</span>, labelsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#show clusters in colour</span></span></span>
<span class="r-in"><span><span class="fu">plotCRT</span><span class="op">(</span><span class="va">example</span>, map <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">'clusters'</span>, showClusterLabels <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>          labelsize<span class="op">=</span><span class="fl">2</span>, maskbuffer<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#show arms</span></span></span>
<span class="r-in"><span><span class="fu">plotCRT</span><span class="op">(</span><span class="va">example</span>, map <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>fill <span class="op">=</span> <span class="st">'arms'</span>, maskbuffer<span class="op">=</span><span class="fl">0.2</span>, legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#spillover plot</span></span></span>
<span class="r-in"><span><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRTanalysis.html">CRTanalysis</a></span><span class="op">(</span><span class="va">example</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">plotCRT</span><span class="op">(</span><span class="va">analysis</span>, map <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     (Intercept) armintervention </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      -0.5172565      -0.7004896 </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>*** No fitted curve available ***</span>
<span class="r-plt img"><img src="plotCRT-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

